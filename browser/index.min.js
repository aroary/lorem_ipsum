/**************************************************************
 * @file lorem ipsum browser extension for visual studio code *
 * @copyright (c) 2021 aroary                                 *
 * @license MIT                                               *
 **************************************************************/
 const vscode=require("vscode"),lat=getLanguageData("lat"),randomItem=e=>e[Math.floor(Math.random()*e.length)],validateInput=e=>isNaN(e)?"Please enter a number":e>1e5?"Number too high":null;function generate(e){const a=getLanguageData(),t=[];for(;t.length<e;)t.push((o=a)[Math.floor(Math.random()*o.length)]);var o;return t}function getLanguageData(e=null){const a=vscode.workspace.getConfiguration("lorem_ipsum");if(!e)return a.get("language")||lat;{const t=`https://aroary.com/lorem_ipsum/languages/${e}.json`;console.log((new Date).toISOString(),"Getting",t);const o=new XMLHttpRequest;o.open("GET",t,!0),o.onload=()=>{if(o.status>=200&&o.status<300)return a.update("language",JSON.parse(o.responseText),!1).then((()=>{vscode.window.showInformationMessage(`Language set to ${e}`),console.log((new Date).toISOString(),"Language updated to",e)})),a.get("language");console.log((new Date).toISOString(),`Error ${o.status}: ${o.statusText}`),vscode.window.showErrorMessage(`Error ${o.status}: ${o.statusText}`)},o.onerror=()=>{console.log((new Date).toISOString(),o.statusText),vscode.window.showErrorMessage("request.statusText")}}}async function byte(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of bytes to generate",validateInput:validateInput});if(!(e=parseInt(e)))return;const a=vscode.window.activeTextEditor;a.edit((t=>{a.selections.forEach((a=>{for(var o=[];o.join` `.length<e;)o.push(generate(1)[0]);" "===(o=o.join` `.slice(0,-(o.join` `.length-e)))[o.length-1]&&(o=o.slice(0,-1)+random("abcdefghijklmnopqrstuvwxyz".split``)),t.replace(a,o),console.log((new Date).toISOString(),"Generated",e,"bytes")}))}))}async function word(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of words to generate",validateInput:validateInput});if(!(e=parseInt(e)))return;const a=vscode.window.activeTextEditor;a.edit((t=>{a.selections.forEach((a=>{t.replace(a,generate(e).join` `),console.log((new Date).toISOString(),"Generated",e,"words")}))}))}async function sentence(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of sentences to generate",validateInput:validateInput});if(!(e=parseInt(e)))return;const a=vscode.window.activeTextEditor;a.edit((t=>{a.selections.forEach((a=>{t.replace(a,new Array(e).fill(void 0).map((()=>generate(Math.floor(4*Math.random())+16).join` `+".")).join` `),console.log((new Date).toISOString(),"Generated",e,"sentences")}))}))}async function paragraph(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of paragraphs to generate",validateInput:validateInput});e=parseInt(e);const a=vscode.window.activeTextEditor;a.edit((t=>{a.selections.forEach((a=>{t.replace(a,new Array(e).fill(void 0).map((()=>new Array(Math.floor(3*Math.random())+5).fill(void 0).map((()=>generate(Math.floor(4*Math.random())+16).join` `+".")).join` `)).join`\n`),console.log((new Date).toISOString(),"Generated",e,"paragraphs")}))}))}async function page(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of pages to generate",validateInput:validateInput});e=parseInt(e);const a=vscode.window.activeTextEditor;a.edit((t=>{a.selections.forEach((a=>{t.replace(a,new Array(e).fill(void 0).map((()=>new Array(Math.floor(3*Math.random())+5).fill(void 0).map((()=>new Array(Math.floor(3*Math.random())+5).fill(void 0).map((()=>generate(Math.floor(4*Math.random())+16).join` `+".")).join` `)).join`\n`)).join`\n\n`),console.log((new Date).toISOString(),"Generated",e,"pages")}))}))}async function code(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of list items to generate",validateInput:validateInput}),a=generate(e=parseInt(e));switch(vscode.window.activeTextEditor.document.languageId){case"plaintext":default:a=a.join`\n`;break;case"xml":case"html":a=`<ul>\n\t<li>${a.join`</li>\n\t<li>`}</li>\n</ul>`;break;case"php":a=`array("${a.join`", "`}")`;break;case"javascript":case"typescript":case"json":a=`[\n\t"${a.join`",\n\t"`}"\n]`;break;case"go":case"java":case"cpp":case"c":a=`{"${a.join`", "`}"}`;break;case"sql":a=`ARRAY["${a.join`", "`}"]`;break;case"markdown":a=`- ${a.join`\n- `}`;break;case"ini":a=`array[] = ${a.join`\narray[] = `}`;break;case"shellscript":a=`(${a.join` `})`;break;case"bat":a=`${a.join` `}`;break;case"ruby":a=`%w("${a.join`, `}")`;break;case"haskell":case"rust":case"python":a=`["${a.join`", "`}"]`;break;case"perl":a=`("${a.join`", "`}")`;break;case"csharp":a=`{ "${a.join`", "`}"; } `;break;case"powershell":a=`@("${a.join`", "`}")`}const t=vscode.window.activeTextEditor;t.edit((e=>e.insert(t.selection.active,a))),console.log((new Date).toISOString(),"Generated",e,"list items")}async function image(){console.log((new Date).toISOString(),"Generating image"),vscode.window.showErrorMessage("Image generation is not available in the browser yet")}function language(){vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Language",validateInput:e=>3!==e.length?"Language code must be 3 characters long":null,prompt:"Enter a language code",value:"lat",valueSelection:void 0},void 0).then((e=>{e&&vscode.workspace.name?getLanguageData(e):console.log((new Date).toISOString(),"Language update failed")}))}const commands=[{execute:byte,name:"byte"},{execute:word,name:"word"},{execute:sentence,name:"sentence"},{execute:paragraph,name:"paragraph"},{execute:page,name:"page"},{execute:code,name:"code"},{execute:image,name:"image"},{execute:language,name:"language"}];function activate(e){console.log((new Date).toISOString(),"lorem_ipsum extension activating"),commands.forEach((a=>{console.log((new Date).toISOString(),`registering command ${a.name}`),e.subscriptions.push(vscode.commands.registerCommand("lorem_ipsum."+a.name,a.execute))})),console.log((new Date).toISOString(),"lorem_ipsum extension activated")}function deactivate(){console.log((new Date).toISOString(),"lorem_ipsum extension deactivating"),console.log((new Date).toISOString(),"lorem_ipsum extension deactivated")}module.exports={activate:activate,deactivate:deactivate};