/***************************************************************
 * @file lorem ipsum browser extension for https://github.dev/ *
 * @copyright (c) 2021 aroary                                  *
 * @license MIT                                                *
 ***************************************************************/
const vscode=require("vscode"),lat=getLanguageData("lat"),randomItem=e=>e[Math.floor(Math.random()*e.length)],validateInput=e=>isNaN(e)?"Please enter a number":e>1e5?"Number too high":null;function generate(e){const t=getLanguageData(),a=[];for(;a.length<e;)a.push((o=t)[Math.floor(Math.random()*o.length)]);var o;return a}function getLanguageData(e=null){const t=vscode.workspace.getConfiguration("lorem_ipsum");if(!e)return t.get("language")||lat;{const a=`https://aroary.com/lorem_ipsum/languages/${e}.json`;console.log((new Date).toISOString(),"Getting",a);const o=new XMLHttpRequest;o.open("GET",a,!0),o.onload=()=>{if(o.status>=200&&o.status<300)return t.update("language",JSON.parse(o.responseText),!1).then((()=>{vscode.window.showInformationMessage(`Language set to ${e}`),console.log((new Date).toISOString(),"Language updated to",e)})),t.get("language");console.log((new Date).toISOString(),`Error ${o.status}: ${o.statusText}`),vscode.window.showErrorMessage(`Error ${o.status}: ${o.statusText}`)},o.onerror=()=>{console.log((new Date).toISOString(),o.statusText),vscode.window.showErrorMessage("request.statusText")}}}async function byte(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of bytes to generate",validateInput:validateInput});if(!(e=parseInt(e)))return;const t=vscode.window.activeTextEditor;t.edit((a=>{t.selections.forEach((t=>{for(var o=[];o.join` `.length<e;)o.push(generate(1)[0]);" "===(o=o.join` `.slice(0,-(o.join` `.length-e)))[o.length-1]&&(o=o.slice(0,-1)+random("abcdefghijklmnopqrstuvwxyz".split``)),a.replace(new vscode.Range(t.start,t.start),o),console.log((new Date).toISOString(),"Generated",e,"bytes")}))}))}async function word(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of words to generate",validateInput:validateInput});if(!(e=parseInt(e)))return;const t=vscode.window.activeTextEditor;t.edit((a=>{t.selections.forEach((t=>{a.insert(t,generate(e).join` `),console.log((new Date).toISOString(),"Generated",e,"words")}))}))}async function sentence(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of sentences to generate",validateInput:validateInput});if(!(e=parseInt(e)))return;const t=vscode.window.activeTextEditor;t.edit((a=>{t.selections.forEach((t=>{const o=[];for(;o.length<e;)o.push(generate(Math.floor(6*Math.random())+16).join` `+".");a.replace(t,o.join` `),console.log((new Date).toISOString(),"Generated",e,"sentences")}))}))}async function paragraph(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of paragraphs to generate",validateInput:validateInput});e=parseInt(e);const t=vscode.window.activeTextEditor;t.edit((a=>{t.selections.forEach((t=>{const o=[];for(let t=0;t<e;t++){for(let e=0;e<Math.floor(3*Math.random())+5;e++)o.push(generate(Math.floor(6*Math.random())+16).join` `+".");o.push("\n")}a.replace(t,o.join` `.split("\n").map((e=>e.trim())).join("\n").trim()),console.log((new Date).toISOString(),"Generated",e,"paragraphs")}))}))}async function page(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of pages to generate",validateInput:validateInput});e=parseInt(e);const t=vscode.window.activeTextEditor;t.edit((a=>{t.selections.forEach((t=>{const o=[];for(let t=0;t<e;t++){for(let e=0;e<Math.floor(3*Math.random())+5;e++){for(let e=0;e<Math.floor(3*Math.random())+5;e++)o.push(generate(Math.floor(6*Math.random())+16).join` `+".");o.push("\n")}o.push("\n")}a.replace(t,o.join` `.split`\n`.map((e=>e.trim())).join`\n`.trim()),console.log((new Date).toISOString(),"Generated",e,"pages")}))}))}async function code(){var e=await vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Number of list items to generate",validateInput:validateInput}),t=generate(e=parseInt(e));switch(vscode.window.activeTextEditor.document.languageId){case"plaintext":default:t=t.join`\n`;break;case"html":case"xml":t=`<ul>\n<li>${t.join`</li>\n<li>`}</li>\n</ul>`;break;case"php":t=`array("${t.join`", "`}")`;break;case"json":case"javascript":case"typescript":t=`[\n"${t.join`",\n\t"`}"\n]`;break;case"c":case"cpp":case"java":case"go":t=`{"${t.join`", "`}"}`;break;case"sql":t=`ARRAY["${t.join`", "`}"]`;break;case"yaml":case"markdown":t=`- ${t.join`\n- `}`;break;case"ini":t=`array[] = ${t.join`\narray[] = `}`;break;case"shellscript":t=`(${t.join` `})`;break;case"bat":t=`${t.join` `}`;break;case"ruby":t=`%w("${t.join`, `}")`;break;case"python":case"rust":case"haskell":t=`["${t.join`", "`}"]`;break;case"perl":t=`("${t.join`", "`}")`;break;case"csharp":t=`{ "${t.join`", "`}"; } `;break;case"powershell":t=`@("${t.join`", "`}")`}const a=vscode.window.activeTextEditor;a.edit((e=>e.insert(a.selection.active,t))),console.log((new Date).toISOString(),"Generated",e,"list items")}async function image(){console.log((new Date).toISOString(),"Generating image"),vscode.window.showErrorMessage("Image generation is not available in the browser yet")}function language(){vscode.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Language",validateInput:e=>3!==e.length?"Language code must be 3 characters long":null,prompt:"Enter a language code",value:"lat",valueSelection:void 0},void 0).then((e=>{e&&vscode.workspace.name?getLanguageData(e):console.log((new Date).toISOString(),"Language update failed")}))}const commands=[{execute:byte,name:"byte"},{execute:word,name:"word"},{execute:sentence,name:"sentence"},{execute:paragraph,name:"paragraph"},{execute:page,name:"page"},{execute:code,name:"code"},{execute:image,name:"image"},{execute:language,name:"language"}];function activate(e){console.log((new Date).toISOString(),"lorem_ipsum extension activating"),commands.forEach((t=>{console.log((new Date).toISOString(),`registering command ${t.name}`),e.subscriptions.push(vscode.commands.registerCommand("lorem_ipsum."+t.name,t.execute))})),console.log((new Date).toISOString(),"lorem_ipsum extension activated")}function deactivate(){console.log((new Date).toISOString(),"lorem_ipsum extension deactivating"),console.log((new Date).toISOString(),"lorem_ipsum extension deactivated")}module.exports={activate:activate,deactivate:deactivate};